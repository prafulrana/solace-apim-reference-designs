components:
  schemas:
    status_update:
      $schema: 'http://json-schema.org/draft-07/schema#'
      additionalProperties: false
      type: object
      title: Elevator Co status update for tracking id
      required:
        - status_update
      properties:
        status_update:
          additionalProperties: false
          type: object
          required:
            - timestamp
            - tracking_id
            - status
          properties:
            tracking_id:
              type: string
              pattern: "^[a-zA-Z0-9-]+$"
            timestamp:
              type: string
            status:
              type: string
              enum:
              - received
              - resolved
      $id: >-
        http://eventportal.solace.cloud/apim/elevator-co/status_update.json
  messages:
    status_update:
      payload:
        $ref: '#/components/schemas/status_update'
      schemaFormat: application/vnd.aai.asyncapi+json;version=2.0.0
      contentType: application/json
      examples:
        - payload: {"status_update":{"timestamp":"2021-02-16-14:54:15-UTC","status":"received","tracking_id":"44ccd43d-7f3e-45a0-a98b-3d75388e3e44"}}
        - payload: {"status_update":{"timestamp":"2021-02-16-14:54:36-UTC","status":"resolved","tracking_id":"fa663bb5-fadb-43b2-80cd-461d4302d503"}}
  parameters:
    tracking_id:
      schema:
        type: string
        pattern: "^[a-zA-Z0-9-]+$"
channels:
  'apim/elevator-co/api/V1/json/status/{tracking_id}':
    subscribe:
      summary: "publish status updates for a specific tracking id"
      operationId: publishStatus
      tags:
        - name: status
        - name: tracking
      message:
        $ref: '#/components/messages/status_update'
      bindings:
        mqtt:
          bindingVersion: ‘0.1.0’
          qos: 1
          retain: false
        http:
          bindingVersion: ‘0.1.0’
          type: request
          method: POST
    parameters:
      tracking_id:
        $ref: '#/components/parameters/tracking_id'
asyncapi: 2.0.0
info:
  x-application-class: unspecified
  title: 'ApiEventService:status_update'
  x-view: consumer
  version: 0.0.3
